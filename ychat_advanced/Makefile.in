SRCS=chat.cpp conf.cpp dir.cpp html.cpp lang.cpp logd.cpp main.cpp modl.cpp mutx.cpp name.cpp pool.cpp reqp.cpp room.cpp sock.cpp thrd.cpp user.cpp sess.cpp sman.cpp mman.cpp mcon.cpp menu.cpp ncur.cpp timr.cpp wrap.cpp tool.cpp smap.cpp gcol.cpp data.cpp
OBJS=$(SRCS:.cpp=.o)
CC=g++
LDFLAGS=@LDFLAGS@ -lstdc++ -lmysqlclient -lncurses -g 
LDADD=-pthread -D_THREAD_SAFE
all: ychat	
modules:
	make -C ./mods
clean_modules:
	make -C ./mods clean
clean_base:
	rm *.o 
$(SRCS): 
	$(CC) $(CFLAGS) -c $*.cpp
base:	$(OBJS)
ychat:  $(OBJS) modules
	$(CC) $(LDFLAGS) -o $@ $(OBJS) $(LDADD)
	perl scripts/buildnr.pl
	perl scripts/stats.pl > stats.txt
	cat stats.txt 2>/dev/null
clean:	clean_base clean_modules
